Ext.define("Ext.ux.GMapPanelRv",{extend:"Ext.panel.Panel",alias:"widget.gmappanel",requires:["Ext.window.MessageBox"],initComponent:function(){Ext.applyIf(this,{plain:true,gmapType:"map",border:false,cache:{marker:[],polyline:[],infowindow:[]}});this.callParent();},afterFirstLayout:function(){var a=this.center;
this.callParent();if(a){if(a.geoCodeAddr){this.lookupCode(a.geoCodeAddr,a.marker);}else{this.createMap(a);}}else{Ext.Error.raise("center is required");}},createMap:function(a,b){options=Ext.apply({},this.mapOptions);options=Ext.applyIf(options,{zoom:Ext.getCmp("mygooglemap").zoom,center:a,panControl:true,mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControl:true,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE}});
this.gmap=new google.maps.Map(this.body.dom,options);var d=publicJSON["latitude"];var c=publicJSON["longitude"];if((d!=null&&d!="null"&&d!="")&&(c!=null&&c!="null"&&c!="")){if(b){this.addMarker(Ext.applyIf(b,{position:a}));}Ext.each(this.markers,this.addMarker,this);}google.maps.event.addListener(this.gmap,"click",function(e){forAddingMarker(e.latLng);
});},addMarker:function(a){a=Ext.apply({map:this.gmap},a);if(!a.position){a.position=new google.maps.LatLng(a.lat,a.lng);}var b=new google.maps.Marker(a);Ext.Object.each(a.listeners,function(c,d){google.maps.event.addListener(b,c,d);});this.cache.marker.push(b);return b;},hideMarkers:function(){Ext.each(this.cache.marker,function(a){a.setMap(null);
});},lookupCode:function(b,a){this.geocoder=new google.maps.Geocoder();this.geocoder.geocode({address:b},Ext.Function.bind(this.onLookupComplete,this,[a],true));},onLookupComplete:function(c,b,a){if(b!="OK"){Ext.MessageBox.alert("Error",'An error occured: "'+b+'"');return;}this.createMap(c[0].geometry.location,a);
},afterComponentLayout:function(a,b){this.callParent(arguments);this.redraw();},redraw:function(){var a=this.gmap;if(a){google.maps.event.trigger(a,"resize");}},getMap:function(){return this.gmap;},getCenter:function(){return this.getMap().getCenter();},getMarkers:function(){return this.markers;},getDomObject:function(){return this.body.dom;
},getMapOptions:function(){return this.mapOptions;},getThisObject:function(){return this;},getZoomLevel:function(a){return this.gmap.getZoom();},setMapType:function(a){if(a=="hybrid"){this.gmap.setMapTypeId(google.maps.MapTypeId.HYBRID);}else{if(a=="terrain"){this.gmap.setMapTypeId(google.maps.MapTypeId.TERRAIN);
}else{if(a=="satellite"){this.gmap.setMapTypeId(google.maps.MapTypeId.SATELLITE);}else{this.gmap.setMapTypeId(google.maps.MapTypeId.ROADMAP);}}}}});